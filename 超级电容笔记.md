# 引言

"超级电容"指能够在供电线路中（典型值24VDC）吸收、释放电能，以削平供电需求峰，从而使得用电器在一个限制功率的电源下有能力进行爆发式用电。

超级电容一般分为两个部分，控制器模块与电容模块。其中电容模块本体一般是容值较大（约3F）、耐压中等（约30V）的电容组。控制器模块则负责给电容充电、从电容放电等等功能。一般来说，电容模块实现较简单。因此本文主要着重超级电容控制器的实现。

电容控制器一般分为：

- 单向电容控制器：其中电能从电源经过第一个模块处理（如降压）之后进入电容，然后由第二个模块处理（如升压）之后供给用电器。
- 双向buck/boost电容控制器：超级电容并联在总供电线路上。当用电器功率较小时，超级电容吸收电能；用电器功率较大时，超级电容释放电能。使用算法进行闭环，使得超级电容释放的功率能恰好弥补电源供电的不足，从而防止电流被倒灌回电源。

本文聚焦于第二种设计，双向buck/boost电容控制。该设计效率较高，连线简洁。

# 电学原理

## 升压与降压

首先回顾经典的升压电路与降压电路。

- Buck降压。下图左侧为非同步Buck电路。而右侧为同步Buck电路，用MOSFET替代了二极管，享受了更低的压降与更灵活的控制。同步Buck电路中，MOSFET经过**控制**，能够在电压正向的时候导通、反向的时候断开，实现了二极管的功能。

    ![image-20230501022459277](assets\buck_asynchronous_synchronous.png)
- Boost升压。下图左侧为非同步Boost电路。而右侧为同步Boost电路。用MOSFET替代二极管。

    ![image-20230501023315945](assets\boost_asynchronous_synchronous.png)

## 双向升降压

在此处，我们使用对称的双半桥四MOSFET，中间为功率电感，如图。

![image-principle-1](assets\h_bridge.png)

理想情况下，每个MOSFET都处于完全关闭/完全打开状态。

### 假设电流总是从左流到右：

（这并不是所有情况。但是它有助于理解这个电路的两种形态。）

- 若将RIGHT_H常导通，RIGHT_L常断开，则电路变为如下图。这就是Buck的拓扑，此时将电路看作同步Buck即可实现将左侧电降压后提供给右侧。

    ![image-20230501021718554](assets\h_bridge_as_buck.png)

- 若将LEFT_H常导通，LEFT_L常断开，则电路变为如下图。这就是Boost的拓扑，此时将电路看作同步Boost即可实现将左侧电升压后提供给右侧。

    ![image-20230501022113001](assets\h_bridge_as_boost.png)

- 若



